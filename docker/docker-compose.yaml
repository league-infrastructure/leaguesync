version: '3.8'

services:
  leaguesync:
    build: .
    container_name: leaguesync-sync

    volumes:
      - leaguesync-data:/opt/leaguesync-data

    restart: unless-stopped

  nginx:
    image: nginx:latest
    container_name: leaguesync-nginx
    volumes:
      - leaguesync-data:/usr/share/nginx/html:ro

    labels:
      caddy: p13sync.do.jointheleague.org
      caddy.reverse_proxy: "{{upstreams 80}}"
      #Password: caddy hash-password --plaintext '4life'
      #caddy.basicauth: "code $2a$14$wbz/q7FylNxYEGnBcwL0furpv4S0y.Oh/27jF3fIg/txzcD7eTRri"
    
    restart: unless-stopped

    networks:
      - caddy


  whoami:
    image: traefik/whoami
    networks:
      - caddy
    labels:
      caddy: whoami.do.jointheleague.org
      caddy.reverse_proxy: "{{upstreams 80}}"

volumes:
  leaguesync-data:

networks:
  caddy:
    external: true


